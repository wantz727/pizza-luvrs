import { __extends } from "tslib";
import { DynamoDBDocumentClient } from "./DynamoDBDocumentClient";
import { BatchExecuteStatementCommand, } from "./commands/BatchExecuteStatementCommand";
import { BatchGetCommand } from "./commands/BatchGetCommand";
import { BatchWriteCommand } from "./commands/BatchWriteCommand";
import { DeleteCommand } from "./commands/DeleteCommand";
import { ExecuteStatementCommand, } from "./commands/ExecuteStatementCommand";
import { ExecuteTransactionCommand, } from "./commands/ExecuteTransactionCommand";
import { GetCommand } from "./commands/GetCommand";
import { PutCommand } from "./commands/PutCommand";
import { QueryCommand } from "./commands/QueryCommand";
import { ScanCommand } from "./commands/ScanCommand";
import { TransactGetCommand } from "./commands/TransactGetCommand";
import { TransactWriteCommand, } from "./commands/TransactWriteCommand";
import { UpdateCommand } from "./commands/UpdateCommand";
/**
 * The document client simplifies working with items in Amazon DynamoDB by
 * abstracting away the notion of attribute values. This abstraction annotates native
 * JavaScript types supplied as input parameters, as well as converts annotated
 * response data to native JavaScript types.
 *
 * ## Marshalling Input and Unmarshalling Response Data
 *
 * The document client affords developers the use of native JavaScript types
 * instead of `AttributeValue`s to simplify the JavaScript development
 * experience with Amazon DynamoDB. JavaScript objects passed in as parameters
 * are marshalled into `AttributeValue` shapes required by Amazon DynamoDB.
 * Responses from DynamoDB are unmarshalled into plain JavaScript objects
 * by the `DocumentClient`. The `DocumentClient` does not accept
 * `AttributeValue`s in favor of native JavaScript types.
 *
 * |          JavaScript Type          | DynamoDB AttributeValue |
 * | :-------------------------------: | ----------------------- |
 * |              String               | S                       |
 * |          Number / BigInt          | N                       |
 * |              Boolean              | BOOL                    |
 * |               null                | NULL                    |
 * |               Array               | L                       |
 * |              Object               | M                       |
 * |   Set\<Uint8Array, Blob, ...\>    | BS                      |
 * |       Set\<Number, BigInt\>       | NS                      |
 * |           Set\<String\>           | SS                      |
 * | Uint8Array, Buffer, File, Blob... | B                       |
 *
 * ### Example
 *
 * Here is an example list which is sent to DynamoDB client in an operation:
 *
 * ```json
 * { "L": [{ "NULL": true }, { "BOOL": false }, { "N": 1 }, { "S": "two" }] }
 * ```
 *
 * The DynamoDB document client abstracts the attribute values as follows in
 * both input and output:
 *
 * ```json
 * [null, false, 1, "two"]
 * ```
 *
 * @see {@link https://www.npmjs.com/package/@aws-sdk/client-dynamodb @aws-sdk/client-dynamodb}
 */
var DynamoDBDocument = /** @class */ (function (_super) {
    __extends(DynamoDBDocument, _super);
    function DynamoDBDocument() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    DynamoDBDocument.from = function (client, translateConfig) {
        return new DynamoDBDocument(client, translateConfig);
    };
    DynamoDBDocument.prototype.batchExecuteStatement = function (args, optionsOrCb, cb) {
        var command = new BatchExecuteStatementCommand(args);
        if (typeof optionsOrCb === "function") {
            this.send(command, optionsOrCb);
        }
        else if (typeof cb === "function") {
            if (typeof optionsOrCb !== "object")
                throw new Error("Expect http options but get " + typeof optionsOrCb);
            this.send(command, optionsOrCb || {}, cb);
        }
        else {
            return this.send(command, optionsOrCb);
        }
    };
    DynamoDBDocument.prototype.batchGet = function (args, optionsOrCb, cb) {
        var command = new BatchGetCommand(args);
        if (typeof optionsOrCb === "function") {
            this.send(command, optionsOrCb);
        }
        else if (typeof cb === "function") {
            if (typeof optionsOrCb !== "object")
                throw new Error("Expect http options but get " + typeof optionsOrCb);
            this.send(command, optionsOrCb || {}, cb);
        }
        else {
            return this.send(command, optionsOrCb);
        }
    };
    DynamoDBDocument.prototype.batchWrite = function (args, optionsOrCb, cb) {
        var command = new BatchWriteCommand(args);
        if (typeof optionsOrCb === "function") {
            this.send(command, optionsOrCb);
        }
        else if (typeof cb === "function") {
            if (typeof optionsOrCb !== "object")
                throw new Error("Expect http options but get " + typeof optionsOrCb);
            this.send(command, optionsOrCb || {}, cb);
        }
        else {
            return this.send(command, optionsOrCb);
        }
    };
    DynamoDBDocument.prototype.delete = function (args, optionsOrCb, cb) {
        var command = new DeleteCommand(args);
        if (typeof optionsOrCb === "function") {
            this.send(command, optionsOrCb);
        }
        else if (typeof cb === "function") {
            if (typeof optionsOrCb !== "object")
                throw new Error("Expect http options but get " + typeof optionsOrCb);
            this.send(command, optionsOrCb || {}, cb);
        }
        else {
            return this.send(command, optionsOrCb);
        }
    };
    DynamoDBDocument.prototype.executeStatement = function (args, optionsOrCb, cb) {
        var command = new ExecuteStatementCommand(args);
        if (typeof optionsOrCb === "function") {
            this.send(command, optionsOrCb);
        }
        else if (typeof cb === "function") {
            if (typeof optionsOrCb !== "object")
                throw new Error("Expect http options but get " + typeof optionsOrCb);
            this.send(command, optionsOrCb || {}, cb);
        }
        else {
            return this.send(command, optionsOrCb);
        }
    };
    DynamoDBDocument.prototype.executeTransaction = function (args, optionsOrCb, cb) {
        var command = new ExecuteTransactionCommand(args);
        if (typeof optionsOrCb === "function") {
            this.send(command, optionsOrCb);
        }
        else if (typeof cb === "function") {
            if (typeof optionsOrCb !== "object")
                throw new Error("Expect http options but get " + typeof optionsOrCb);
            this.send(command, optionsOrCb || {}, cb);
        }
        else {
            return this.send(command, optionsOrCb);
        }
    };
    DynamoDBDocument.prototype.get = function (args, optionsOrCb, cb) {
        var command = new GetCommand(args);
        if (typeof optionsOrCb === "function") {
            this.send(command, optionsOrCb);
        }
        else if (typeof cb === "function") {
            if (typeof optionsOrCb !== "object")
                throw new Error("Expect http options but get " + typeof optionsOrCb);
            this.send(command, optionsOrCb || {}, cb);
        }
        else {
            return this.send(command, optionsOrCb);
        }
    };
    DynamoDBDocument.prototype.put = function (args, optionsOrCb, cb) {
        var command = new PutCommand(args);
        if (typeof optionsOrCb === "function") {
            this.send(command, optionsOrCb);
        }
        else if (typeof cb === "function") {
            if (typeof optionsOrCb !== "object")
                throw new Error("Expect http options but get " + typeof optionsOrCb);
            this.send(command, optionsOrCb || {}, cb);
        }
        else {
            return this.send(command, optionsOrCb);
        }
    };
    DynamoDBDocument.prototype.query = function (args, optionsOrCb, cb) {
        var command = new QueryCommand(args);
        if (typeof optionsOrCb === "function") {
            this.send(command, optionsOrCb);
        }
        else if (typeof cb === "function") {
            if (typeof optionsOrCb !== "object")
                throw new Error("Expect http options but get " + typeof optionsOrCb);
            this.send(command, optionsOrCb || {}, cb);
        }
        else {
            return this.send(command, optionsOrCb);
        }
    };
    DynamoDBDocument.prototype.scan = function (args, optionsOrCb, cb) {
        var command = new ScanCommand(args);
        if (typeof optionsOrCb === "function") {
            this.send(command, optionsOrCb);
        }
        else if (typeof cb === "function") {
            if (typeof optionsOrCb !== "object")
                throw new Error("Expect http options but get " + typeof optionsOrCb);
            this.send(command, optionsOrCb || {}, cb);
        }
        else {
            return this.send(command, optionsOrCb);
        }
    };
    DynamoDBDocument.prototype.transactGet = function (args, optionsOrCb, cb) {
        var command = new TransactGetCommand(args);
        if (typeof optionsOrCb === "function") {
            this.send(command, optionsOrCb);
        }
        else if (typeof cb === "function") {
            if (typeof optionsOrCb !== "object")
                throw new Error("Expect http options but get " + typeof optionsOrCb);
            this.send(command, optionsOrCb || {}, cb);
        }
        else {
            return this.send(command, optionsOrCb);
        }
    };
    DynamoDBDocument.prototype.transactWrite = function (args, optionsOrCb, cb) {
        var command = new TransactWriteCommand(args);
        if (typeof optionsOrCb === "function") {
            this.send(command, optionsOrCb);
        }
        else if (typeof cb === "function") {
            if (typeof optionsOrCb !== "object")
                throw new Error("Expect http options but get " + typeof optionsOrCb);
            this.send(command, optionsOrCb || {}, cb);
        }
        else {
            return this.send(command, optionsOrCb);
        }
    };
    DynamoDBDocument.prototype.update = function (args, optionsOrCb, cb) {
        var command = new UpdateCommand(args);
        if (typeof optionsOrCb === "function") {
            this.send(command, optionsOrCb);
        }
        else if (typeof cb === "function") {
            if (typeof optionsOrCb !== "object")
                throw new Error("Expect http options but get " + typeof optionsOrCb);
            this.send(command, optionsOrCb || {}, cb);
        }
        else {
            return this.send(command, optionsOrCb);
        }
    };
    return DynamoDBDocument;
}(DynamoDBDocumentClient));
export { DynamoDBDocument };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRHluYW1vREJEb2N1bWVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9EeW5hbW9EQkRvY3VtZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUUsc0JBQXNCLEVBQW1CLE1BQU0sMEJBQTBCLENBQUM7QUFDbkYsT0FBTyxFQUNMLDRCQUE0QixHQUc3QixNQUFNLHlDQUF5QyxDQUFDO0FBQ2pELE9BQU8sRUFBRSxlQUFlLEVBQStDLE1BQU0sNEJBQTRCLENBQUM7QUFDMUcsT0FBTyxFQUFFLGlCQUFpQixFQUFtRCxNQUFNLDhCQUE4QixDQUFDO0FBQ2xILE9BQU8sRUFBRSxhQUFhLEVBQTJDLE1BQU0sMEJBQTBCLENBQUM7QUFDbEcsT0FBTyxFQUNMLHVCQUF1QixHQUd4QixNQUFNLG9DQUFvQyxDQUFDO0FBQzVDLE9BQU8sRUFDTCx5QkFBeUIsR0FHMUIsTUFBTSxzQ0FBc0MsQ0FBQztBQUM5QyxPQUFPLEVBQUUsVUFBVSxFQUFxQyxNQUFNLHVCQUF1QixDQUFDO0FBQ3RGLE9BQU8sRUFBRSxVQUFVLEVBQXFDLE1BQU0sdUJBQXVCLENBQUM7QUFDdEYsT0FBTyxFQUFFLFlBQVksRUFBeUMsTUFBTSx5QkFBeUIsQ0FBQztBQUM5RixPQUFPLEVBQUUsV0FBVyxFQUF1QyxNQUFNLHdCQUF3QixDQUFDO0FBQzFGLE9BQU8sRUFBRSxrQkFBa0IsRUFBcUQsTUFBTSwrQkFBK0IsQ0FBQztBQUN0SCxPQUFPLEVBQ0wsb0JBQW9CLEdBR3JCLE1BQU0saUNBQWlDLENBQUM7QUFDekMsT0FBTyxFQUFFLGFBQWEsRUFBMkMsTUFBTSwwQkFBMEIsQ0FBQztBQUlsRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBNkNHO0FBQ0g7SUFBc0Msb0NBQXNCO0lBQTVEOztJQWthQSxDQUFDO0lBamFRLHFCQUFJLEdBQVgsVUFBWSxNQUFzQixFQUFFLGVBQWlDO1FBQ25FLE9BQU8sSUFB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QUFDLENBQUM7U0FDakM7YUFBTSxJQUFJLE9BQU8sRUFBRSxLQUFLLFVBQVUsRUFBRTtZQUNuQyxJQUFJLE9BQU8sV0FBVyxLQUFLLFFBQVE7Z0JBQUUsTUFBTSxJQUFJLEtBQUssQ0FBQyxpQ0FBK0IsT0FBTyxXQUFhLENBQUMsQ0FBQztZQUMxRyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxXQUFXLElBQUksRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1NBQzNDO2FBQU07WUFDTCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFdBQVcsQ0FBQyxDQUFDO1NBQ3hDO0lBQ0gsQ0FBQztJQWdCTSxpQ0FBTSxHQUFiLFVBQ0UsSUFBd0IsRUFDeEIsV0FBcUYsRUFDckYsRUFBbUQ7UUFFbkQsSUFBTSxPQUFPLEdBQUcsSUFBSSxhQUFhLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDeEMsSUFBSSxPQUFPLFdBQVcsS0FBSyxVQUFVLEVBQUU7WUFDckMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLEVBQUUsV0FBVyxDQUFDLENBQUM7U0FDakM7YUFBTSxJQUFJLE9BQU8sRUFBRSxLQUFLLFVBQVUsRUFBRTtZQUNuQyxJQUFJLE9BQU8sV0FBVyxLQUFLLFFBQVE7Z0JBQUUsTUFBTSxJQUFJLEtBQUssQ0FBQyxpQ0FBK0IsT0FBTyxXQUFhLENBQUMsQ0FBQztZQUMxRyxJQUFJLENBQUMsSUFBSSxDQUFDLE9BQU8sRUFBRSxXQUFXLElBQUksRUFBRSxFQUFFLEVBQUUsQ0FBQyxDQUFDO1NBQzNDO2FBQU07WUFDTCxPQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBTyxFQUFFLFdBQVcsQ0FBQyxDQUFDO1NBQ3hDO0lBQ0gsQ0FBQztJQUNILHVCQUFDO0FBQUQsQ0FBQyxBQWxhRCxDQUFzQyxzQkFBc0IsR0FrYTNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRHluYW1vREJEb2N1bWVudENsaWVudCwgVHJhbnNsYXRlQ29uZmlnIH0gZnJvbSBcIi4vRHluYW1vREJEb2N1bWVudENsaWVudFwiO1xuaW1wb3J0IHtcbiAgQmF0Y2hFeGVjdXRlU3RhdGVtZW50Q29tbWFuZCxcbiAgQmF0Y2hFeGVjdXRlU3RhdGVtZW50Q29tbWFuZElucHV0LFxuICBCYXRjaEV4ZWN1dGVTdGF0ZW1lbnRDb21tYW5kT3V0cHV0LFxufSBmcm9tIFwiLi9jb21tYW5kcy9CYXRjaEV4ZWN1dGVTdGF0ZW1lbnRDb21tYW5kXCI7XG5pbXBvcnQgeyBCYXRjaEdldENvbW1hbmQsIEJhdGNoR2V0Q29tbWFuZElucHV0LCBCYXRjaEdldENvbW1hbmRPdXRwdXQgfSBmcm9tIFwiLi9jb21tYW5kcy9CYXRjaEdldENvbW1hbmRcIjtcbmltcG9ydCB7IEJhdGNoV3JpdGVDb21tYW5kLCBCYXRjaFdyaXRlQ29tbWFuZElucHV0LCBCYXRjaFdyaXRlQ29tbWFuZE91dHB1dCB9IGZyb20gXCIuL2NvbW1hbmRzL0JhdGNoV3JpdGVDb21tYW5kXCI7XG5pbXBvcnQgeyBEZWxldGVDb21tYW5kLCBEZWxldGVDb21tYW5kSW5wdXQsIERlbGV0ZUNvbW1hbmRPdXRwdXQgfSBmcm9tIFwiLi9jb21tYW5kcy9EZWxldGVDb21tYW5kXCI7XG5pbXBvcnQge1xuICBFeGVjdXRlU3RhdGVtZW50Q29tbWFuZCxcbiAgRXhlY3V0ZVN0YXRlbWVudENvbW1hbmRJbnB1dCxcbiAgRXhlY3V0ZVN0YXRlbWVudENvbW1hbmRPdXRwdXQsXG59IGZyb20gXCIuL2NvbW1hbmRzL0V4ZWN1dGVTdGF0ZW1lbnRDb21tYW5kXCI7XG5pbXBvcnQge1xuICBFeGVjdXRlVHJhbnNhY3Rpb25Db21tYW5kLFxuICBFeGVjdXRlVHJhbnNhY3Rpb25Db21tYW5kSW5wdXQsXG4gIEV4ZWN1dGVUcmFuc2FjdGlvbkNvbW1hbmRPdXRwdXQsXG59IGZyb20gXCIuL2NvbW1hbmRzL0V4ZWN1dGVUcmFuc2FjdGlvbkNvbW1hbmRcIjtcbmltcG9ydCB7IEdldENvbW1hbmQsIEdldENvbW1hbmRJbnB1dCwgR2V0Q29tbWFuZE91dHB1dCB9IGZyb20gXCIuL2NvbW1hbmRzL0dldENvbW1hbmRcIjtcbmltcG9ydCB7IFB1dENvbW1hbmQsIFB1dENvbW1hbmRJbnB1dCwgUHV0Q29tbWFuZE91dHB1dCB9IGZyb20gXCIuL2NvbW1hbmRzL1B1dENvbW1hbmRcIjtcbmltcG9ydCB7IFF1ZXJ5Q29tbWFuZCwgUXVlcnlDb21tYW5kSW5wdXQsIFF1ZXJ5Q29tbWFuZE91dHB1dCB9IGZyb20gXCIuL2NvbW1hbmRzL1F1ZXJ5Q29tbWFuZFwiO1xuaW1wb3J0IHsgU2NhbkNvbW1hbmQsIFNjYW5Db21tYW5kSW5wdXQsIFNjYW5Db21tYW5kT3V0cHV0IH0gZnJvbSBcIi4vY29tbWFuZHMvU2NhbkNvbW1hbmRcIjtcbmltcG9ydCB7IFRyYW5zYWN0R2V0Q29tbWFuZCwgVHJhbnNhY3RHZXRDb21tYW5kSW5wdXQsIFRyYW5zYWN0R2V0Q29tbWFuZE91dHB1dCB9IGZyb20gXCIuL2NvbW1hbmRzL1RyYW5zYWN0R2V0Q29tbWFuZFwiO1xuaW1wb3J0IHtcbiAgVHJhbnNhY3RXcml0ZUNvbW1hbmQsXG4gIFRyYW5zYWN0V3JpdGVDb21tYW5kSW5wdXQsXG4gIFRyYW5zYWN0V3JpdGVDb21tYW5kT3V0cHV0LFxufSBmcm9tIFwiLi9jb21tYW5kcy9UcmFuc2FjdFdyaXRlQ29tbWFuZFwiO1xuaW1wb3J0IHsgVXBkYXRlQ29tbWFuZCwgVXBkYXRlQ29tbWFuZElucHV0LCBVcGRhdGVDb21tYW5kT3V0cHV0IH0gZnJvbSBcIi4vY29tbWFuZHMvVXBkYXRlQ29tbWFuZFwiO1xuaW1wb3J0IHsgRHluYW1vREJDbGllbnQgfSBmcm9tIFwiQGF3cy1zZGsvY2xpZW50LWR5bmFtb2RiXCI7XG5pbXBvcnQgeyBIdHRwSGFuZGxlck9wdGlvbnMgYXMgX19IdHRwSGFuZGxlck9wdGlvbnMgfSBmcm9tIFwiQGF3cy1zZGsvdHlwZXNcIjtcblxuLyoqXG4gKiBUaGUgZG9jdW1lbnQgY2xpZW50IHNpbXBsaWZpZXMgd29ya2luZyB3aXRoIGl0ZW1zIGluIEFtYXpvbiBEeW5hbW9EQiBieVxuICogYWJzdHJhY3RpbmcgYXdheSB0aGUgbm90aW9uIG9mIGF0dHJpYnV0ZSB2YWx1ZXMuIFRoaXMgYWJzdHJhY3Rpb24gYW5ub3RhdGVzIG5hdGl2ZVxuICogSmF2YVNjcmlwdCB0eXBlcyBzdXBwbGllZCBhcyBpbnB1dCBwYXJhbWV0ZXJzLCBhcyB3ZWxsIGFzIGNvbnZlcnRzIGFubm90YXRlZFxuICogcmVzcG9uc2UgZGF0YSB0byBuYXRpdmUgSmF2YVNjcmlwdCB0eXBlcy5cbiAqXG4gKiAjIyBNYXJzaGFsbGluZyBJbnB1dCBhbmQgVW5tYXJzaGFsbGluZyBSZXNwb25zZSBEYXRhXG4gKlxuICogVGhlIGRvY3VtZW50IGNsaWVudCBhZmZvcmRzIGRldmVsb3BlcnMgdGhlIHVzZSBvZiBuYXRpdmUgSmF2YVNjcmlwdCB0eXBlc1xuICogaW5zdGVhZCBvZiBgQXR0cmlidXRlVmFsdWVgcyB0byBzaW1wbGlmeSB0aGUgSmF2YVNjcmlwdCBkZXZlbG9wbWVudFxuICogZXhwZXJpZW5jZSB3aXRoIEFtYXpvbiBEeW5hbW9EQi4gSmF2YVNjcmlwdCBvYmplY3RzIHBhc3NlZCBpbiBhcyBwYXJhbWV0ZXJzXG4gKiBhcmUgbWFyc2hhbGxlZCBpbnRvIGBBdHRyaWJ1dGVWYWx1ZWAgc2hhcGVzIHJlcXVpcmVkIGJ5IEFtYXpvbiBEeW5hbW9EQi5cbiAqIFJlc3BvbnNlcyBmcm9tIER5bmFtb0RCIGFyZSB1bm1hcnNoYWxsZWQgaW50byBwbGFpbiBKYXZhU2NyaXB0IG9iamVjdHNcbiAqIGJ5IHRoZSBgRG9jdW1lbnRDbGllbnRgLiBUaGUgYERvY3VtZW50Q2xpZW50YCBkb2VzIG5vdCBhY2NlcHRcbiAqIGBBdHRyaWJ1dGVWYWx1ZWBzIGluIGZhdm9yIG9mIG5hdGl2ZSBKYXZhU2NyaXB0IHR5cGVzLlxuICpcbiAqIHwgICAgICAgICAgSmF2YVNjcmlwdCBUeXBlICAgICAgICAgIHwgRHluYW1vREIgQXR0cmlidXRlVmFsdWUgfFxuICogfCA6LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLTogfCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSB8XG4gKiB8ICAgICAgICAgICAgICBTdHJpbmcgICAgICAgICAgICAgICB8IFMgICAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwgICAgICAgICAgTnVtYmVyIC8gQmlnSW50ICAgICAgICAgIHwgTiAgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCAgICAgICAgICAgICAgQm9vbGVhbiAgICAgICAgICAgICAgfCBCT09MICAgICAgICAgICAgICAgICAgICB8XG4gKiB8ICAgICAgICAgICAgICAgbnVsbCAgICAgICAgICAgICAgICB8IE5VTEwgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwgICAgICAgICAgICAgICBBcnJheSAgICAgICAgICAgICAgIHwgTCAgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCAgICAgICAgICAgICAgT2JqZWN0ICAgICAgICAgICAgICAgfCBNICAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8ICAgU2V0XFw8VWludDhBcnJheSwgQmxvYiwgLi4uXFw+ICAgIHwgQlMgICAgICAgICAgICAgICAgICAgICAgfFxuICogfCAgICAgICBTZXRcXDxOdW1iZXIsIEJpZ0ludFxcPiAgICAgICB8IE5TICAgICAgICAgICAgICAgICAgICAgIHxcbiAqIHwgICAgICAgICAgIFNldFxcPFN0cmluZ1xcPiAgICAgICAgICAgfCBTUyAgICAgICAgICAgICAgICAgICAgICB8XG4gKiB8IFVpbnQ4QXJyYXksIEJ1ZmZlciwgRmlsZSwgQmxvYi4uLiB8IEIgICAgICAgICAgICAgICAgICAgICAgIHxcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICpcbiAqIEhlcmUgaXMgYW4gZXhhbXBsZSBsaXN0IHdoaWNoIGlzIHNlbnQgdG8gRHluYW1vREIgY2xpZW50IGluIGFuIG9wZXJhdGlvbjpcbiAqXG4gKiBgYGBqc29uXG4gKiB7IFwiTFwiOiBbeyBcIk5VTExcIjogdHJ1ZSB9LCB7IFwiQk9PTFwiOiBmYWxzZSB9LCB7IFwiTlwiOiAxIH0sIHsgXCJTXCI6IFwidHdvXCIgfV0gfVxuICogYGBgXG4gKlxuICogVGhlIER5bmFtb0RCIGRvY3VtZW50IGNsaWVudCBhYnN0cmFjdHMgdGhlIGF0dHJpYnV0ZSB2YWx1ZXMgYXMgZm9sbG93cyBpblxuICogYm90aCBpbnB1dCBhbmQgb3V0cHV0OlxuICpcbiAqIGBgYGpzb25cbiAqIFtudWxsLCBmYWxzZSwgMSwgXCJ0d29cIl1cbiAqIGBgYFxuICpcbiAqIEBzZWUge0BsaW5rIGh0dHBzOi8vd3d3Lm5wbWpzLmNvbS9wYWNrYWdlL0Bhd3Mtc2RrL2NsaWVudC1keW5hbW9kYiBAYXdzLXNkay9jbGllbnQtZHluYW1vZGJ9XG4gKi9cbmV4cG9ydCBjbGFzcyBEeW5hbW9EQkRvY3VtZW50IGV4dGVuZHMgRHluYW1vREJEb2N1bWVudENsaWVudCB7XG4gIHN0YXRpYyBmcm9tKGNsaWVudDogRHluYW1vREJDbGllbnQsIHRyYW5zbGF0ZUNvbmZpZz86IFRyYW5zbGF0ZUNvbmZpZykge1xuICAgIHJldHVybiBuZXcgRHluYW1vREJEb2N1bWVudChjbGllbnQsIHRyYW5zbGF0ZUNvbmZpZyk7XG4gIH1cblxuICAvKipcbiAgICogQWNjZXB0cyBuYXRpdmUgSmF2YVNjcmlwdCB0eXBlcyBpbnN0ZWFkIG9mIGBBdHRyaWJ1dGVWYWx1ZWBzLCBhbmQgY2FsbHNcbiAgICogQmF0Y2hFeGVjdXRlU3RhdGVtZW50Q29tbWFuZCBvcGVyYXRpb24gZnJvbSB7QGxpbmsgaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvQGF3cy1zZGsvY2xpZW50LWR5bmFtb2RiIEBhd3Mtc2RrL2NsaWVudC1keW5hbW9kYn0uXG4gICAqXG4gICAqIEphdmFTY3JpcHQgb2JqZWN0cyBwYXNzZWQgaW4gYXMgcGFyYW1ldGVycyBhcmUgbWFyc2hhbGxlZCBpbnRvIGBBdHRyaWJ1dGVWYWx1ZWAgc2hhcGVzXG4gICAqIHJlcXVpcmVkIGJ5IEFtYXpvbiBEeW5hbW9EQi4gUmVzcG9uc2VzIGZyb20gRHluYW1vREIgYXJlIHVubWFyc2hhbGxlZCBpbnRvIHBsYWluIEphdmFTY3JpcHQgb2JqZWN0cy5cbiAgICovXG4gIHB1YmxpYyBiYXRjaEV4ZWN1dGVTdGF0ZW1lbnQoXG4gICAgYXJnczogQmF0Y2hFeGVjdXRlU3RhdGVtZW50Q29tbWFuZElucHV0LFxuICAgIG9wdGlvbnM/OiBfX0h0dHBIYW5kbGVyT3B0aW9uc1xuICApOiBQcm9taXNlPEJhdGNoRXhlY3V0ZVN0YXRlbWVudENvbW1hbmRPdXRwdXQ+O1xuICBwdWJsaWMgYmF0Y2hFeGVjdXRlU3RhdGVtZW50KFxuICAgIGFyZ3M6IEJhdGNoRXhlY3V0ZVN0YXRlbWVudENvbW1hbmRJbnB1dCxcbiAgICBjYjogKGVycjogYW55LCBkYXRhPzogQmF0Y2hFeGVjdXRlU3RhdGVtZW50Q29tbWFuZE91dHB1dCkgPT4gdm9pZFxuICApOiB2b2lkO1xuICBwdWJsaWMgYmF0Y2hFeGVjdXRlU3RhdGVtZW50KFxuICAgIGFyZ3M6IEJhdGNoRXhlY3V0ZVN0YXRlbWVudENvbW1hbmRJbnB1dCxcbiAgICBvcHRpb25zOiBfX0h0dHBIYW5kbGVyT3B0aW9ucyxcbiAgICBjYjogKGVycjogYW55LCBkYXRhPzogQmF0Y2hFeGVjdXRlU3RhdGVtZW50Q29tbWFuZE91dHB1dCkgPT4gdm9pZFxuICApOiB2b2lkO1xuICBwdWJsaWMgYmF0Y2hFeGVjdXRlU3RhdGVtZW50KFxuICAgIGFyZ3M6IEJhdGNoRXhlY3V0ZVN0YXRlbWVudENvbW1hbmRJbnB1dCxcbiAgICBvcHRpb25zT3JDYj86IF9fSHR0cEhhbmRsZXJPcHRpb25zIHwgKChlcnI6IGFueSwgZGF0YT86IEJhdGNoRXhlY3V0ZVN0YXRlbWVudENvbW1hbmRPdXRwdXQpID0+IHZvaWQpLFxuICAgIGNiPzogKGVycjogYW55LCBkYXRhPzogQmF0Y2hFeGVjdXRlU3RhdGVtZW50Q29tbWFuZE91dHB1dCkgPT4gdm9pZFxuICApOiBQcm9taXNlPEJhdGNoRXhlY3V0ZVN0YXRlbWVudENvbW1hbmRPdXRwdXQ+IHwgdm9pZCB7XG4gICAgY29uc3QgY29tbWFuZCA9IG5ldyBCYXRjaEV4ZWN1dGVTdGF0ZW1lbnRDb21tYW5kKGFyZ3MpO1xuICAgIGlmICh0eXBlb2Ygb3B0aW9uc09yQ2IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgdGhpcy5zZW5kKGNvbW1hbmQsIG9wdGlvbnNPckNiKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBjYiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBpZiAodHlwZW9mIG9wdGlvbnNPckNiICE9PSBcIm9iamVjdFwiKSB0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdCBodHRwIG9wdGlvbnMgYnV0IGdldCAke3R5cGVvZiBvcHRpb25zT3JDYn1gKTtcbiAgICAgIHRoaXMuc2VuZChjb21tYW5kLCBvcHRpb25zT3JDYiB8fCB7fSwgY2IpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5zZW5kKGNvbW1hbmQsIG9wdGlvbnNPckNiKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWNjZXB0cyBuYXRpdmUgSmF2YVNjcmlwdCB0eXBlcyBpbnN0ZWFkIG9mIGBBdHRyaWJ1dGVWYWx1ZWBzLCBhbmQgY2FsbHNcbiAgICogQmF0Y2hHZXRJdGVtQ29tbWFuZCBvcGVyYXRpb24gZnJvbSB7QGxpbmsgaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvQGF3cy1zZGsvY2xpZW50LWR5bmFtb2RiIEBhd3Mtc2RrL2NsaWVudC1keW5hbW9kYn0uXG4gICAqXG4gICAqIEphdmFTY3JpcHQgb2JqZWN0cyBwYXNzZWQgaW4gYXMgcGFyYW1ldGVycyBhcmUgbWFyc2hhbGxlZCBpbnRvIGBBdHRyaWJ1dGVWYWx1ZWAgc2hhcGVzXG4gICAqIHJlcXVpcmVkIGJ5IEFtYXpvbiBEeW5hbW9EQi4gUmVzcG9uc2VzIGZyb20gRHluYW1vREIgYXJlIHVubWFyc2hhbGxlZCBpbnRvIHBsYWluIEphdmFTY3JpcHQgb2JqZWN0cy5cbiAgICovXG4gIHB1YmxpYyBiYXRjaEdldChhcmdzOiBCYXRjaEdldENvbW1hbmRJbnB1dCwgb3B0aW9ucz86IF9fSHR0cEhhbmRsZXJPcHRpb25zKTogUHJvbWlzZTxCYXRjaEdldENvbW1hbmRPdXRwdXQ+O1xuICBwdWJsaWMgYmF0Y2hHZXQoYXJnczogQmF0Y2hHZXRDb21tYW5kSW5wdXQsIGNiOiAoZXJyOiBhbnksIGRhdGE/OiBCYXRjaEdldENvbW1hbmRPdXRwdXQpID0+IHZvaWQpOiB2b2lkO1xuICBwdWJsaWMgYmF0Y2hHZXQoXG4gICAgYXJnczogQmF0Y2hHZXRDb21tYW5kSW5wdXQsXG4gICAgb3B0aW9uczogX19IdHRwSGFuZGxlck9wdGlvbnMsXG4gICAgY2I6IChlcnI6IGFueSwgZGF0YT86IEJhdGNoR2V0Q29tbWFuZE91dHB1dCkgPT4gdm9pZFxuICApOiB2b2lkO1xuICBwdWJsaWMgYmF0Y2hHZXQoXG4gICAgYXJnczogQmF0Y2hHZXRDb21tYW5kSW5wdXQsXG4gICAgb3B0aW9uc09yQ2I/OiBfX0h0dHBIYW5kbGVyT3B0aW9ucyB8ICgoZXJyOiBhbnksIGRhdGE/OiBCYXRjaEdldENvbW1hbmRPdXRwdXQpID0+IHZvaWQpLFxuICAgIGNiPzogKGVycjogYW55LCBkYXRhPzogQmF0Y2hHZXRDb21tYW5kT3V0cHV0KSA9PiB2b2lkXG4gICk6IFByb21pc2U8QmF0Y2hHZXRDb21tYW5kT3V0cHV0PiB8IHZvaWQge1xuICAgIGNvbnN0IGNvbW1hbmQgPSBuZXcgQmF0Y2hHZXRDb21tYW5kKGFyZ3MpO1xuICAgIGlmICh0eXBlb2Ygb3B0aW9uc09yQ2IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgdGhpcy5zZW5kKGNvbW1hbmQsIG9wdGlvbnNPckNiKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBjYiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBpZiAodHlwZW9mIG9wdGlvbnNPckNiICE9PSBcIm9iamVjdFwiKSB0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdCBodHRwIG9wdGlvbnMgYnV0IGdldCAke3R5cGVvZiBvcHRpb25zT3JDYn1gKTtcbiAgICAgIHRoaXMuc2VuZChjb21tYW5kLCBvcHRpb25zT3JDYiB8fCB7fSwgY2IpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5zZW5kKGNvbW1hbmQsIG9wdGlvbnNPckNiKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWNjZXB0cyBuYXRpdmUgSmF2YVNjcmlwdCB0eXBlcyBpbnN0ZWFkIG9mIGBBdHRyaWJ1dGVWYWx1ZWBzLCBhbmQgY2FsbHNcbiAgICogQmF0Y2hXcml0ZUl0ZW1Db21tYW5kIG9wZXJhdGlvbiBmcm9tIHtAbGluayBodHRwczovL3d3dy5ucG1qcy5jb20vcGFja2FnZS9AYXdzLXNkay9jbGllbnQtZHluYW1vZGIgQGF3cy1zZGsvY2xpZW50LWR5bmFtb2RifS5cbiAgICpcbiAgICogSmF2YVNjcmlwdCBvYmplY3RzIHBhc3NlZCBpbiBhcyBwYXJhbWV0ZXJzIGFyZSBtYXJzaGFsbGVkIGludG8gYEF0dHJpYnV0ZVZhbHVlYCBzaGFwZXNcbiAgICogcmVxdWlyZWQgYnkgQW1hem9uIER5bmFtb0RCLiBSZXNwb25zZXMgZnJvbSBEeW5hbW9EQiBhcmUgdW5tYXJzaGFsbGVkIGludG8gcGxhaW4gSmF2YVNjcmlwdCBvYmplY3RzLlxuICAgKi9cbiAgcHVibGljIGJhdGNoV3JpdGUoYXJnczogQmF0Y2hXcml0ZUNvbW1hbmRJbnB1dCwgb3B0aW9ucz86IF9fSHR0cEhhbmRsZXJPcHRpb25zKTogUHJvbWlzZTxCYXRjaFdyaXRlQ29tbWFuZE91dHB1dD47XG4gIHB1YmxpYyBiYXRjaFdyaXRlKGFyZ3M6IEJhdGNoV3JpdGVDb21tYW5kSW5wdXQsIGNiOiAoZXJyOiBhbnksIGRhdGE/OiBCYXRjaFdyaXRlQ29tbWFuZE91dHB1dCkgPT4gdm9pZCk6IHZvaWQ7XG4gIHB1YmxpYyBiYXRjaFdyaXRlKFxuICAgIGFyZ3M6IEJhdGNoV3JpdGVDb21tYW5kSW5wdXQsXG4gICAgb3B0aW9uczogX19IdHRwSGFuZGxlck9wdGlvbnMsXG4gICAgY2I6IChlcnI6IGFueSwgZGF0YT86IEJhdGNoV3JpdGVDb21tYW5kT3V0cHV0KSA9PiB2b2lkXG4gICk6IHZvaWQ7XG4gIHB1YmxpYyBiYXRjaFdyaXRlKFxuICAgIGFyZ3M6IEJhdGNoV3JpdGVDb21tYW5kSW5wdXQsXG4gICAgb3B0aW9uc09yQ2I/OiBfX0h0dHBIYW5kbGVyT3B0aW9ucyB8ICgoZXJyOiBhbnksIGRhdGE/OiBCYXRjaFdyaXRlQ29tbWFuZE91dHB1dCkgPT4gdm9pZCksXG4gICAgY2I/OiAoZXJyOiBhbnksIGRhdGE/OiBCYXRjaFdyaXRlQ29tbWFuZE91dHB1dCkgPT4gdm9pZFxuICApOiBQcm9taXNlPEJhdGNoV3JpdGVDb21tYW5kT3V0cHV0PiB8IHZvaWQge1xuICAgIGNvbnN0IGNvbW1hbmQgPSBuZXcgQmF0Y2hXcml0ZUNvbW1hbmQoYXJncyk7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zT3JDYiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICB0aGlzLnNlbmQoY29tbWFuZCwgb3B0aW9uc09yQ2IpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGNiID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9uc09yQ2IgIT09IFwib2JqZWN0XCIpIHRocm93IG5ldyBFcnJvcihgRXhwZWN0IGh0dHAgb3B0aW9ucyBidXQgZ2V0ICR7dHlwZW9mIG9wdGlvbnNPckNifWApO1xuICAgICAgdGhpcy5zZW5kKGNvbW1hbmQsIG9wdGlvbnNPckNiIHx8IHt9LCBjYik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLnNlbmQoY29tbWFuZCwgb3B0aW9uc09yQ2IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBY2NlcHRzIG5hdGl2ZSBKYXZhU2NyaXB0IHR5cGVzIGluc3RlYWQgb2YgYEF0dHJpYnV0ZVZhbHVlYHMsIGFuZCBjYWxsc1xuICAgKiBEZWxldGVJdGVtQ29tbWFuZCBvcGVyYXRpb24gZnJvbSB7QGxpbmsgaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvQGF3cy1zZGsvY2xpZW50LWR5bmFtb2RiIEBhd3Mtc2RrL2NsaWVudC1keW5hbW9kYn0uXG4gICAqXG4gICAqIEphdmFTY3JpcHQgb2JqZWN0cyBwYXNzZWQgaW4gYXMgcGFyYW1ldGVycyBhcmUgbWFyc2hhbGxlZCBpbnRvIGBBdHRyaWJ1dGVWYWx1ZWAgc2hhcGVzXG4gICAqIHJlcXVpcmVkIGJ5IEFtYXpvbiBEeW5hbW9EQi4gUmVzcG9uc2VzIGZyb20gRHluYW1vREIgYXJlIHVubWFyc2hhbGxlZCBpbnRvIHBsYWluIEphdmFTY3JpcHQgb2JqZWN0cy5cbiAgICovXG4gIHB1YmxpYyBkZWxldGUoYXJnczogRGVsZXRlQ29tbWFuZElucHV0LCBvcHRpb25zPzogX19IdHRwSGFuZGxlck9wdGlvbnMpOiBQcm9taXNlPERlbGV0ZUNvbW1hbmRPdXRwdXQ+O1xuICBwdWJsaWMgZGVsZXRlKGFyZ3M6IERlbGV0ZUNvbW1hbmRJbnB1dCwgY2I6IChlcnI6IGFueSwgZGF0YT86IERlbGV0ZUNvbW1hbmRPdXRwdXQpID0+IHZvaWQpOiB2b2lkO1xuICBwdWJsaWMgZGVsZXRlKFxuICAgIGFyZ3M6IERlbGV0ZUNvbW1hbmRJbnB1dCxcbiAgICBvcHRpb25zOiBfX0h0dHBIYW5kbGVyT3B0aW9ucyxcbiAgICBjYjogKGVycjogYW55LCBkYXRhPzogRGVsZXRlQ29tbWFuZE91dHB1dCkgPT4gdm9pZFxuICApOiB2b2lkO1xuICBwdWJsaWMgZGVsZXRlKFxuICAgIGFyZ3M6IERlbGV0ZUNvbW1hbmRJbnB1dCxcbiAgICBvcHRpb25zT3JDYj86IF9fSHR0cEhhbmRsZXJPcHRpb25zIHwgKChlcnI6IGFueSwgZGF0YT86IERlbGV0ZUNvbW1hbmRPdXRwdXQpID0+IHZvaWQpLFxuICAgIGNiPzogKGVycjogYW55LCBkYXRhPzogRGVsZXRlQ29tbWFuZE91dHB1dCkgPT4gdm9pZFxuICApOiBQcm9taXNlPERlbGV0ZUNvbW1hbmRPdXRwdXQ+IHwgdm9pZCB7XG4gICAgY29uc3QgY29tbWFuZCA9IG5ldyBEZWxldGVDb21tYW5kKGFyZ3MpO1xuICAgIGlmICh0eXBlb2Ygb3B0aW9uc09yQ2IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgdGhpcy5zZW5kKGNvbW1hbmQsIG9wdGlvbnNPckNiKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBjYiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBpZiAodHlwZW9mIG9wdGlvbnNPckNiICE9PSBcIm9iamVjdFwiKSB0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdCBodHRwIG9wdGlvbnMgYnV0IGdldCAke3R5cGVvZiBvcHRpb25zT3JDYn1gKTtcbiAgICAgIHRoaXMuc2VuZChjb21tYW5kLCBvcHRpb25zT3JDYiB8fCB7fSwgY2IpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5zZW5kKGNvbW1hbmQsIG9wdGlvbnNPckNiKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWNjZXB0cyBuYXRpdmUgSmF2YVNjcmlwdCB0eXBlcyBpbnN0ZWFkIG9mIGBBdHRyaWJ1dGVWYWx1ZWBzLCBhbmQgY2FsbHNcbiAgICogRXhlY3V0ZVN0YXRlbWVudENvbW1hbmQgb3BlcmF0aW9uIGZyb20ge0BsaW5rIGh0dHBzOi8vd3d3Lm5wbWpzLmNvbS9wYWNrYWdlL0Bhd3Mtc2RrL2NsaWVudC1keW5hbW9kYiBAYXdzLXNkay9jbGllbnQtZHluYW1vZGJ9LlxuICAgKlxuICAgKiBKYXZhU2NyaXB0IG9iamVjdHMgcGFzc2VkIGluIGFzIHBhcmFtZXRlcnMgYXJlIG1hcnNoYWxsZWQgaW50byBgQXR0cmlidXRlVmFsdWVgIHNoYXBlc1xuICAgKiByZXF1aXJlZCBieSBBbWF6b24gRHluYW1vREIuIFJlc3BvbnNlcyBmcm9tIER5bmFtb0RCIGFyZSB1bm1hcnNoYWxsZWQgaW50byBwbGFpbiBKYXZhU2NyaXB0IG9iamVjdHMuXG4gICAqL1xuICBwdWJsaWMgZXhlY3V0ZVN0YXRlbWVudChcbiAgICBhcmdzOiBFeGVjdXRlU3RhdGVtZW50Q29tbWFuZElucHV0LFxuICAgIG9wdGlvbnM/OiBfX0h0dHBIYW5kbGVyT3B0aW9uc1xuICApOiBQcm9taXNlPEV4ZWN1dGVTdGF0ZW1lbnRDb21tYW5kT3V0cHV0PjtcbiAgcHVibGljIGV4ZWN1dGVTdGF0ZW1lbnQoXG4gICAgYXJnczogRXhlY3V0ZVN0YXRlbWVudENvbW1hbmRJbnB1dCxcbiAgICBjYjogKGVycjogYW55LCBkYXRhPzogRXhlY3V0ZVN0YXRlbWVudENvbW1hbmRPdXRwdXQpID0+IHZvaWRcbiAgKTogdm9pZDtcbiAgcHVibGljIGV4ZWN1dGVTdGF0ZW1lbnQoXG4gICAgYXJnczogRXhlY3V0ZVN0YXRlbWVudENvbW1hbmRJbnB1dCxcbiAgICBvcHRpb25zOiBfX0h0dHBIYW5kbGVyT3B0aW9ucyxcbiAgICBjYjogKGVycjogYW55LCBkYXRhPzogRXhlY3V0ZVN0YXRlbWVudENvbW1hbmRPdXRwdXQpID0+IHZvaWRcbiAgKTogdm9pZDtcbiAgcHVibGljIGV4ZWN1dGVTdGF0ZW1lbnQoXG4gICAgYXJnczogRXhlY3V0ZVN0YXRlbWVudENvbW1hbmRJbnB1dCxcbiAgICBvcHRpb25zT3JDYj86IF9fSHR0cEhhbmRsZXJPcHRpb25zIHwgKChlcnI6IGFueSwgZGF0YT86IEV4ZWN1dGVTdGF0ZW1lbnRDb21tYW5kT3V0cHV0KSA9PiB2b2lkKSxcbiAgICBjYj86IChlcnI6IGFueSwgZGF0YT86IEV4ZWN1dGVTdGF0ZW1lbnRDb21tYW5kT3V0cHV0KSA9PiB2b2lkXG4gICk6IFByb21pc2U8RXhlY3V0ZVN0YXRlbWVudENvbW1hbmRPdXRwdXQ+IHwgdm9pZCB7XG4gICAgY29uc3QgY29tbWFuZCA9IG5ldyBFeGVjdXRlU3RhdGVtZW50Q29tbWFuZChhcmdzKTtcbiAgICBpZiAodHlwZW9mIG9wdGlvbnNPckNiID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHRoaXMuc2VuZChjb21tYW5kLCBvcHRpb25zT3JDYik7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgY2IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgaWYgKHR5cGVvZiBvcHRpb25zT3JDYiAhPT0gXCJvYmplY3RcIikgdGhyb3cgbmV3IEVycm9yKGBFeHBlY3QgaHR0cCBvcHRpb25zIGJ1dCBnZXQgJHt0eXBlb2Ygb3B0aW9uc09yQ2J9YCk7XG4gICAgICB0aGlzLnNlbmQoY29tbWFuZCwgb3B0aW9uc09yQ2IgfHwge30sIGNiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuc2VuZChjb21tYW5kLCBvcHRpb25zT3JDYik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFjY2VwdHMgbmF0aXZlIEphdmFTY3JpcHQgdHlwZXMgaW5zdGVhZCBvZiBgQXR0cmlidXRlVmFsdWVgcywgYW5kIGNhbGxzXG4gICAqIEV4ZWN1dGVUcmFuc2FjdGlvbkNvbW1hbmQgb3BlcmF0aW9uIGZyb20ge0BsaW5rIGh0dHBzOi8vd3d3Lm5wbWpzLmNvbS9wYWNrYWdlL0Bhd3Mtc2RrL2NsaWVudC1keW5hbW9kYiBAYXdzLXNkay9jbGllbnQtZHluYW1vZGJ9LlxuICAgKlxuICAgKiBKYXZhU2NyaXB0IG9iamVjdHMgcGFzc2VkIGluIGFzIHBhcmFtZXRlcnMgYXJlIG1hcnNoYWxsZWQgaW50byBgQXR0cmlidXRlVmFsdWVgIHNoYXBlc1xuICAgKiByZXF1aXJlZCBieSBBbWF6b24gRHluYW1vREIuIFJlc3BvbnNlcyBmcm9tIER5bmFtb0RCIGFyZSB1bm1hcnNoYWxsZWQgaW50byBwbGFpbiBKYXZhU2NyaXB0IG9iamVjdHMuXG4gICAqL1xuICBwdWJsaWMgZXhlY3V0ZVRyYW5zYWN0aW9uKFxuICAgIGFyZ3M6IEV4ZWN1dGVUcmFuc2FjdGlvbkNvbW1hbmRJbnB1dCxcbiAgICBvcHRpb25zPzogX19IdHRwSGFuZGxlck9wdGlvbnNcbiAgKTogUHJvbWlzZTxFeGVjdXRlVHJhbnNhY3Rpb25Db21tYW5kT3V0cHV0PjtcbiAgcHVibGljIGV4ZWN1dGVUcmFuc2FjdGlvbihcbiAgICBhcmdzOiBFeGVjdXRlVHJhbnNhY3Rpb25Db21tYW5kSW5wdXQsXG4gICAgY2I6IChlcnI6IGFueSwgZGF0YT86IEV4ZWN1dGVUcmFuc2FjdGlvbkNvbW1hbmRPdXRwdXQpID0+IHZvaWRcbiAgKTogdm9pZDtcbiAgcHVibGljIGV4ZWN1dGVUcmFuc2FjdGlvbihcbiAgICBhcmdzOiBFeGVjdXRlVHJhbnNhY3Rpb25Db21tYW5kSW5wdXQsXG4gICAgb3B0aW9uczogX19IdHRwSGFuZGxlck9wdGlvbnMsXG4gICAgY2I6IChlcnI6IGFueSwgZGF0YT86IEV4ZWN1dGVUcmFuc2FjdGlvbkNvbW1hbmRPdXRwdXQpID0+IHZvaWRcbiAgKTogdm9pZDtcbiAgcHVibGljIGV4ZWN1dGVUcmFuc2FjdGlvbihcbiAgICBhcmdzOiBFeGVjdXRlVHJhbnNhY3Rpb25Db21tYW5kSW5wdXQsXG4gICAgb3B0aW9uc09yQ2I/OiBfX0h0dHBIYW5kbGVyT3B0aW9ucyB8ICgoZXJyOiBhbnksIGRhdGE/OiBFeGVjdXRlVHJhbnNhY3Rpb25Db21tYW5kT3V0cHV0KSA9PiB2b2lkKSxcbiAgICBjYj86IChlcnI6IGFueSwgZGF0YT86IEV4ZWN1dGVUcmFuc2FjdGlvbkNvbW1hbmRPdXRwdXQpID0+IHZvaWRcbiAgKTogUHJvbWlzZTxFeGVjdXRlVHJhbnNhY3Rpb25Db21tYW5kT3V0cHV0PiB8IHZvaWQge1xuICAgIGNvbnN0IGNvbW1hbmQgPSBuZXcgRXhlY3V0ZVRyYW5zYWN0aW9uQ29tbWFuZChhcmdzKTtcbiAgICBpZiAodHlwZW9mIG9wdGlvbnNPckNiID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHRoaXMuc2VuZChjb21tYW5kLCBvcHRpb25zT3JDYik7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgY2IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgaWYgKHR5cGVvZiBvcHRpb25zT3JDYiAhPT0gXCJvYmplY3RcIikgdGhyb3cgbmV3IEVycm9yKGBFeHBlY3QgaHR0cCBvcHRpb25zIGJ1dCBnZXQgJHt0eXBlb2Ygb3B0aW9uc09yQ2J9YCk7XG4gICAgICB0aGlzLnNlbmQoY29tbWFuZCwgb3B0aW9uc09yQ2IgfHwge30sIGNiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuc2VuZChjb21tYW5kLCBvcHRpb25zT3JDYik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFjY2VwdHMgbmF0aXZlIEphdmFTY3JpcHQgdHlwZXMgaW5zdGVhZCBvZiBgQXR0cmlidXRlVmFsdWVgcywgYW5kIGNhbGxzXG4gICAqIEdldEl0ZW1Db21tYW5kIG9wZXJhdGlvbiBmcm9tIHtAbGluayBodHRwczovL3d3dy5ucG1qcy5jb20vcGFja2FnZS9AYXdzLXNkay9jbGllbnQtZHluYW1vZGIgQGF3cy1zZGsvY2xpZW50LWR5bmFtb2RifS5cbiAgICpcbiAgICogSmF2YVNjcmlwdCBvYmplY3RzIHBhc3NlZCBpbiBhcyBwYXJhbWV0ZXJzIGFyZSBtYXJzaGFsbGVkIGludG8gYEF0dHJpYnV0ZVZhbHVlYCBzaGFwZXNcbiAgICogcmVxdWlyZWQgYnkgQW1hem9uIER5bmFtb0RCLiBSZXNwb25zZXMgZnJvbSBEeW5hbW9EQiBhcmUgdW5tYXJzaGFsbGVkIGludG8gcGxhaW4gSmF2YVNjcmlwdCBvYmplY3RzLlxuICAgKi9cbiAgcHVibGljIGdldChhcmdzOiBHZXRDb21tYW5kSW5wdXQsIG9wdGlvbnM/OiBfX0h0dHBIYW5kbGVyT3B0aW9ucyk6IFByb21pc2U8R2V0Q29tbWFuZE91dHB1dD47XG4gIHB1YmxpYyBnZXQoYXJnczogR2V0Q29tbWFuZElucHV0LCBjYjogKGVycjogYW55LCBkYXRhPzogR2V0Q29tbWFuZE91dHB1dCkgPT4gdm9pZCk6IHZvaWQ7XG4gIHB1YmxpYyBnZXQoXG4gICAgYXJnczogR2V0Q29tbWFuZElucHV0LFxuICAgIG9wdGlvbnM6IF9fSHR0cEhhbmRsZXJPcHRpb25zLFxuICAgIGNiOiAoZXJyOiBhbnksIGRhdGE/OiBHZXRDb21tYW5kT3V0cHV0KSA9PiB2b2lkXG4gICk6IHZvaWQ7XG4gIHB1YmxpYyBnZXQoXG4gICAgYXJnczogR2V0Q29tbWFuZElucHV0LFxuICAgIG9wdGlvbnNPckNiPzogX19IdHRwSGFuZGxlck9wdGlvbnMgfCAoKGVycjogYW55LCBkYXRhPzogR2V0Q29tbWFuZE91dHB1dCkgPT4gdm9pZCksXG4gICAgY2I/OiAoZXJyOiBhbnksIGRhdGE/OiBHZXRDb21tYW5kT3V0cHV0KSA9PiB2b2lkXG4gICk6IFByb21pc2U8R2V0Q29tbWFuZE91dHB1dD4gfCB2b2lkIHtcbiAgICBjb25zdCBjb21tYW5kID0gbmV3IEdldENvbW1hbmQoYXJncyk7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zT3JDYiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICB0aGlzLnNlbmQoY29tbWFuZCwgb3B0aW9uc09yQ2IpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGNiID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9uc09yQ2IgIT09IFwib2JqZWN0XCIpIHRocm93IG5ldyBFcnJvcihgRXhwZWN0IGh0dHAgb3B0aW9ucyBidXQgZ2V0ICR7dHlwZW9mIG9wdGlvbnNPckNifWApO1xuICAgICAgdGhpcy5zZW5kKGNvbW1hbmQsIG9wdGlvbnNPckNiIHx8IHt9LCBjYik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLnNlbmQoY29tbWFuZCwgb3B0aW9uc09yQ2IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBY2NlcHRzIG5hdGl2ZSBKYXZhU2NyaXB0IHR5cGVzIGluc3RlYWQgb2YgYEF0dHJpYnV0ZVZhbHVlYHMsIGFuZCBjYWxsc1xuICAgKiBQdXRJdGVtQ29tbWFuZCBvcGVyYXRpb24gZnJvbSB7QGxpbmsgaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvQGF3cy1zZGsvY2xpZW50LWR5bmFtb2RiIEBhd3Mtc2RrL2NsaWVudC1keW5hbW9kYn0uXG4gICAqXG4gICAqIEphdmFTY3JpcHQgb2JqZWN0cyBwYXNzZWQgaW4gYXMgcGFyYW1ldGVycyBhcmUgbWFyc2hhbGxlZCBpbnRvIGBBdHRyaWJ1dGVWYWx1ZWAgc2hhcGVzXG4gICAqIHJlcXVpcmVkIGJ5IEFtYXpvbiBEeW5hbW9EQi4gUmVzcG9uc2VzIGZyb20gRHluYW1vREIgYXJlIHVubWFyc2hhbGxlZCBpbnRvIHBsYWluIEphdmFTY3JpcHQgb2JqZWN0cy5cbiAgICovXG4gIHB1YmxpYyBwdXQoYXJnczogUHV0Q29tbWFuZElucHV0LCBvcHRpb25zPzogX19IdHRwSGFuZGxlck9wdGlvbnMpOiBQcm9taXNlPFB1dENvbW1hbmRPdXRwdXQ+O1xuICBwdWJsaWMgcHV0KGFyZ3M6IFB1dENvbW1hbmRJbnB1dCwgY2I6IChlcnI6IGFueSwgZGF0YT86IFB1dENvbW1hbmRPdXRwdXQpID0+IHZvaWQpOiB2b2lkO1xuICBwdWJsaWMgcHV0KFxuICAgIGFyZ3M6IFB1dENvbW1hbmRJbnB1dCxcbiAgICBvcHRpb25zOiBfX0h0dHBIYW5kbGVyT3B0aW9ucyxcbiAgICBjYjogKGVycjogYW55LCBkYXRhPzogUHV0Q29tbWFuZE91dHB1dCkgPT4gdm9pZFxuICApOiB2b2lkO1xuICBwdWJsaWMgcHV0KFxuICAgIGFyZ3M6IFB1dENvbW1hbmRJbnB1dCxcbiAgICBvcHRpb25zT3JDYj86IF9fSHR0cEhhbmRsZXJPcHRpb25zIHwgKChlcnI6IGFueSwgZGF0YT86IFB1dENvbW1hbmRPdXRwdXQpID0+IHZvaWQpLFxuICAgIGNiPzogKGVycjogYW55LCBkYXRhPzogUHV0Q29tbWFuZE91dHB1dCkgPT4gdm9pZFxuICApOiBQcm9taXNlPFB1dENvbW1hbmRPdXRwdXQ+IHwgdm9pZCB7XG4gICAgY29uc3QgY29tbWFuZCA9IG5ldyBQdXRDb21tYW5kKGFyZ3MpO1xuICAgIGlmICh0eXBlb2Ygb3B0aW9uc09yQ2IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgdGhpcy5zZW5kKGNvbW1hbmQsIG9wdGlvbnNPckNiKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBjYiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBpZiAodHlwZW9mIG9wdGlvbnNPckNiICE9PSBcIm9iamVjdFwiKSB0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdCBodHRwIG9wdGlvbnMgYnV0IGdldCAke3R5cGVvZiBvcHRpb25zT3JDYn1gKTtcbiAgICAgIHRoaXMuc2VuZChjb21tYW5kLCBvcHRpb25zT3JDYiB8fCB7fSwgY2IpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5zZW5kKGNvbW1hbmQsIG9wdGlvbnNPckNiKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWNjZXB0cyBuYXRpdmUgSmF2YVNjcmlwdCB0eXBlcyBpbnN0ZWFkIG9mIGBBdHRyaWJ1dGVWYWx1ZWBzLCBhbmQgY2FsbHNcbiAgICogUXVlcnlDb21tYW5kIG9wZXJhdGlvbiBmcm9tIHtAbGluayBodHRwczovL3d3dy5ucG1qcy5jb20vcGFja2FnZS9AYXdzLXNkay9jbGllbnQtZHluYW1vZGIgQGF3cy1zZGsvY2xpZW50LWR5bmFtb2RifS5cbiAgICpcbiAgICogSmF2YVNjcmlwdCBvYmplY3RzIHBhc3NlZCBpbiBhcyBwYXJhbWV0ZXJzIGFyZSBtYXJzaGFsbGVkIGludG8gYEF0dHJpYnV0ZVZhbHVlYCBzaGFwZXNcbiAgICogcmVxdWlyZWQgYnkgQW1hem9uIER5bmFtb0RCLiBSZXNwb25zZXMgZnJvbSBEeW5hbW9EQiBhcmUgdW5tYXJzaGFsbGVkIGludG8gcGxhaW4gSmF2YVNjcmlwdCBvYmplY3RzLlxuICAgKi9cbiAgcHVibGljIHF1ZXJ5KGFyZ3M6IFF1ZXJ5Q29tbWFuZElucHV0LCBvcHRpb25zPzogX19IdHRwSGFuZGxlck9wdGlvbnMpOiBQcm9taXNlPFF1ZXJ5Q29tbWFuZE91dHB1dD47XG4gIHB1YmxpYyBxdWVyeShhcmdzOiBRdWVyeUNvbW1hbmRJbnB1dCwgY2I6IChlcnI6IGFueSwgZGF0YT86IFF1ZXJ5Q29tbWFuZE91dHB1dCkgPT4gdm9pZCk6IHZvaWQ7XG4gIHB1YmxpYyBxdWVyeShcbiAgICBhcmdzOiBRdWVyeUNvbW1hbmRJbnB1dCxcbiAgICBvcHRpb25zOiBfX0h0dHBIYW5kbGVyT3B0aW9ucyxcbiAgICBjYjogKGVycjogYW55LCBkYXRhPzogUXVlcnlDb21tYW5kT3V0cHV0KSA9PiB2b2lkXG4gICk6IHZvaWQ7XG4gIHB1YmxpYyBxdWVyeShcbiAgICBhcmdzOiBRdWVyeUNvbW1hbmRJbnB1dCxcbiAgICBvcHRpb25zT3JDYj86IF9fSHR0cEhhbmRsZXJPcHRpb25zIHwgKChlcnI6IGFueSwgZGF0YT86IFF1ZXJ5Q29tbWFuZE91dHB1dCkgPT4gdm9pZCksXG4gICAgY2I/OiAoZXJyOiBhbnksIGRhdGE/OiBRdWVyeUNvbW1hbmRPdXRwdXQpID0+IHZvaWRcbiAgKTogUHJvbWlzZTxRdWVyeUNvbW1hbmRPdXRwdXQ+IHwgdm9pZCB7XG4gICAgY29uc3QgY29tbWFuZCA9IG5ldyBRdWVyeUNvbW1hbmQoYXJncyk7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zT3JDYiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICB0aGlzLnNlbmQoY29tbWFuZCwgb3B0aW9uc09yQ2IpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGNiID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9uc09yQ2IgIT09IFwib2JqZWN0XCIpIHRocm93IG5ldyBFcnJvcihgRXhwZWN0IGh0dHAgb3B0aW9ucyBidXQgZ2V0ICR7dHlwZW9mIG9wdGlvbnNPckNifWApO1xuICAgICAgdGhpcy5zZW5kKGNvbW1hbmQsIG9wdGlvbnNPckNiIHx8IHt9LCBjYik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLnNlbmQoY29tbWFuZCwgb3B0aW9uc09yQ2IpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBBY2NlcHRzIG5hdGl2ZSBKYXZhU2NyaXB0IHR5cGVzIGluc3RlYWQgb2YgYEF0dHJpYnV0ZVZhbHVlYHMsIGFuZCBjYWxsc1xuICAgKiBTY2FuQ29tbWFuZCBvcGVyYXRpb24gZnJvbSB7QGxpbmsgaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvQGF3cy1zZGsvY2xpZW50LWR5bmFtb2RiIEBhd3Mtc2RrL2NsaWVudC1keW5hbW9kYn0uXG4gICAqXG4gICAqIEphdmFTY3JpcHQgb2JqZWN0cyBwYXNzZWQgaW4gYXMgcGFyYW1ldGVycyBhcmUgbWFyc2hhbGxlZCBpbnRvIGBBdHRyaWJ1dGVWYWx1ZWAgc2hhcGVzXG4gICAqIHJlcXVpcmVkIGJ5IEFtYXpvbiBEeW5hbW9EQi4gUmVzcG9uc2VzIGZyb20gRHluYW1vREIgYXJlIHVubWFyc2hhbGxlZCBpbnRvIHBsYWluIEphdmFTY3JpcHQgb2JqZWN0cy5cbiAgICovXG4gIHB1YmxpYyBzY2FuKGFyZ3M6IFNjYW5Db21tYW5kSW5wdXQsIG9wdGlvbnM/OiBfX0h0dHBIYW5kbGVyT3B0aW9ucyk6IFByb21pc2U8U2NhbkNvbW1hbmRPdXRwdXQ+O1xuICBwdWJsaWMgc2NhbihhcmdzOiBTY2FuQ29tbWFuZElucHV0LCBjYjogKGVycjogYW55LCBkYXRhPzogU2NhbkNvbW1hbmRPdXRwdXQpID0+IHZvaWQpOiB2b2lkO1xuICBwdWJsaWMgc2NhbihcbiAgICBhcmdzOiBTY2FuQ29tbWFuZElucHV0LFxuICAgIG9wdGlvbnM6IF9fSHR0cEhhbmRsZXJPcHRpb25zLFxuICAgIGNiOiAoZXJyOiBhbnksIGRhdGE/OiBTY2FuQ29tbWFuZE91dHB1dCkgPT4gdm9pZFxuICApOiB2b2lkO1xuICBwdWJsaWMgc2NhbihcbiAgICBhcmdzOiBTY2FuQ29tbWFuZElucHV0LFxuICAgIG9wdGlvbnNPckNiPzogX19IdHRwSGFuZGxlck9wdGlvbnMgfCAoKGVycjogYW55LCBkYXRhPzogU2NhbkNvbW1hbmRPdXRwdXQpID0+IHZvaWQpLFxuICAgIGNiPzogKGVycjogYW55LCBkYXRhPzogU2NhbkNvbW1hbmRPdXRwdXQpID0+IHZvaWRcbiAgKTogUHJvbWlzZTxTY2FuQ29tbWFuZE91dHB1dD4gfCB2b2lkIHtcbiAgICBjb25zdCBjb21tYW5kID0gbmV3IFNjYW5Db21tYW5kKGFyZ3MpO1xuICAgIGlmICh0eXBlb2Ygb3B0aW9uc09yQ2IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgdGhpcy5zZW5kKGNvbW1hbmQsIG9wdGlvbnNPckNiKTtcbiAgICB9IGVsc2UgaWYgKHR5cGVvZiBjYiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICBpZiAodHlwZW9mIG9wdGlvbnNPckNiICE9PSBcIm9iamVjdFwiKSB0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdCBodHRwIG9wdGlvbnMgYnV0IGdldCAke3R5cGVvZiBvcHRpb25zT3JDYn1gKTtcbiAgICAgIHRoaXMuc2VuZChjb21tYW5kLCBvcHRpb25zT3JDYiB8fCB7fSwgY2IpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gdGhpcy5zZW5kKGNvbW1hbmQsIG9wdGlvbnNPckNiKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogQWNjZXB0cyBuYXRpdmUgSmF2YVNjcmlwdCB0eXBlcyBpbnN0ZWFkIG9mIGBBdHRyaWJ1dGVWYWx1ZWBzLCBhbmQgY2FsbHNcbiAgICogVHJhbnNhY3RHZXRJdGVtc0NvbW1hbmQgb3BlcmF0aW9uIGZyb20ge0BsaW5rIGh0dHBzOi8vd3d3Lm5wbWpzLmNvbS9wYWNrYWdlL0Bhd3Mtc2RrL2NsaWVudC1keW5hbW9kYiBAYXdzLXNkay9jbGllbnQtZHluYW1vZGJ9LlxuICAgKlxuICAgKiBKYXZhU2NyaXB0IG9iamVjdHMgcGFzc2VkIGluIGFzIHBhcmFtZXRlcnMgYXJlIG1hcnNoYWxsZWQgaW50byBgQXR0cmlidXRlVmFsdWVgIHNoYXBlc1xuICAgKiByZXF1aXJlZCBieSBBbWF6b24gRHluYW1vREIuIFJlc3BvbnNlcyBmcm9tIER5bmFtb0RCIGFyZSB1bm1hcnNoYWxsZWQgaW50byBwbGFpbiBKYXZhU2NyaXB0IG9iamVjdHMuXG4gICAqL1xuICBwdWJsaWMgdHJhbnNhY3RHZXQoYXJnczogVHJhbnNhY3RHZXRDb21tYW5kSW5wdXQsIG9wdGlvbnM/OiBfX0h0dHBIYW5kbGVyT3B0aW9ucyk6IFByb21pc2U8VHJhbnNhY3RHZXRDb21tYW5kT3V0cHV0PjtcbiAgcHVibGljIHRyYW5zYWN0R2V0KGFyZ3M6IFRyYW5zYWN0R2V0Q29tbWFuZElucHV0LCBjYjogKGVycjogYW55LCBkYXRhPzogVHJhbnNhY3RHZXRDb21tYW5kT3V0cHV0KSA9PiB2b2lkKTogdm9pZDtcbiAgcHVibGljIHRyYW5zYWN0R2V0KFxuICAgIGFyZ3M6IFRyYW5zYWN0R2V0Q29tbWFuZElucHV0LFxuICAgIG9wdGlvbnM6IF9fSHR0cEhhbmRsZXJPcHRpb25zLFxuICAgIGNiOiAoZXJyOiBhbnksIGRhdGE/OiBUcmFuc2FjdEdldENvbW1hbmRPdXRwdXQpID0+IHZvaWRcbiAgKTogdm9pZDtcbiAgcHVibGljIHRyYW5zYWN0R2V0KFxuICAgIGFyZ3M6IFRyYW5zYWN0R2V0Q29tbWFuZElucHV0LFxuICAgIG9wdGlvbnNPckNiPzogX19IdHRwSGFuZGxlck9wdGlvbnMgfCAoKGVycjogYW55LCBkYXRhPzogVHJhbnNhY3RHZXRDb21tYW5kT3V0cHV0KSA9PiB2b2lkKSxcbiAgICBjYj86IChlcnI6IGFueSwgZGF0YT86IFRyYW5zYWN0R2V0Q29tbWFuZE91dHB1dCkgPT4gdm9pZFxuICApOiBQcm9taXNlPFRyYW5zYWN0R2V0Q29tbWFuZE91dHB1dD4gfCB2b2lkIHtcbiAgICBjb25zdCBjb21tYW5kID0gbmV3IFRyYW5zYWN0R2V0Q29tbWFuZChhcmdzKTtcbiAgICBpZiAodHlwZW9mIG9wdGlvbnNPckNiID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHRoaXMuc2VuZChjb21tYW5kLCBvcHRpb25zT3JDYik7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgY2IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgaWYgKHR5cGVvZiBvcHRpb25zT3JDYiAhPT0gXCJvYmplY3RcIikgdGhyb3cgbmV3IEVycm9yKGBFeHBlY3QgaHR0cCBvcHRpb25zIGJ1dCBnZXQgJHt0eXBlb2Ygb3B0aW9uc09yQ2J9YCk7XG4gICAgICB0aGlzLnNlbmQoY29tbWFuZCwgb3B0aW9uc09yQ2IgfHwge30sIGNiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuc2VuZChjb21tYW5kLCBvcHRpb25zT3JDYik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFjY2VwdHMgbmF0aXZlIEphdmFTY3JpcHQgdHlwZXMgaW5zdGVhZCBvZiBgQXR0cmlidXRlVmFsdWVgcywgYW5kIGNhbGxzXG4gICAqIFRyYW5zYWN0V3JpdGVJdGVtc0NvbW1hbmQgb3BlcmF0aW9uIGZyb20ge0BsaW5rIGh0dHBzOi8vd3d3Lm5wbWpzLmNvbS9wYWNrYWdlL0Bhd3Mtc2RrL2NsaWVudC1keW5hbW9kYiBAYXdzLXNkay9jbGllbnQtZHluYW1vZGJ9LlxuICAgKlxuICAgKiBKYXZhU2NyaXB0IG9iamVjdHMgcGFzc2VkIGluIGFzIHBhcmFtZXRlcnMgYXJlIG1hcnNoYWxsZWQgaW50byBgQXR0cmlidXRlVmFsdWVgIHNoYXBlc1xuICAgKiByZXF1aXJlZCBieSBBbWF6b24gRHluYW1vREIuIFJlc3BvbnNlcyBmcm9tIER5bmFtb0RCIGFyZSB1bm1hcnNoYWxsZWQgaW50byBwbGFpbiBKYXZhU2NyaXB0IG9iamVjdHMuXG4gICAqL1xuICBwdWJsaWMgdHJhbnNhY3RXcml0ZShcbiAgICBhcmdzOiBUcmFuc2FjdFdyaXRlQ29tbWFuZElucHV0LFxuICAgIG9wdGlvbnM/OiBfX0h0dHBIYW5kbGVyT3B0aW9uc1xuICApOiBQcm9taXNlPFRyYW5zYWN0V3JpdGVDb21tYW5kT3V0cHV0PjtcbiAgcHVibGljIHRyYW5zYWN0V3JpdGUoXG4gICAgYXJnczogVHJhbnNhY3RXcml0ZUNvbW1hbmRJbnB1dCxcbiAgICBjYjogKGVycjogYW55LCBkYXRhPzogVHJhbnNhY3RXcml0ZUNvbW1hbmRPdXRwdXQpID0+IHZvaWRcbiAgKTogdm9pZDtcbiAgcHVibGljIHRyYW5zYWN0V3JpdGUoXG4gICAgYXJnczogVHJhbnNhY3RXcml0ZUNvbW1hbmRJbnB1dCxcbiAgICBvcHRpb25zOiBfX0h0dHBIYW5kbGVyT3B0aW9ucyxcbiAgICBjYjogKGVycjogYW55LCBkYXRhPzogVHJhbnNhY3RXcml0ZUNvbW1hbmRPdXRwdXQpID0+IHZvaWRcbiAgKTogdm9pZDtcbiAgcHVibGljIHRyYW5zYWN0V3JpdGUoXG4gICAgYXJnczogVHJhbnNhY3RXcml0ZUNvbW1hbmRJbnB1dCxcbiAgICBvcHRpb25zT3JDYj86IF9fSHR0cEhhbmRsZXJPcHRpb25zIHwgKChlcnI6IGFueSwgZGF0YT86IFRyYW5zYWN0V3JpdGVDb21tYW5kT3V0cHV0KSA9PiB2b2lkKSxcbiAgICBjYj86IChlcnI6IGFueSwgZGF0YT86IFRyYW5zYWN0V3JpdGVDb21tYW5kT3V0cHV0KSA9PiB2b2lkXG4gICk6IFByb21pc2U8VHJhbnNhY3RXcml0ZUNvbW1hbmRPdXRwdXQ+IHwgdm9pZCB7XG4gICAgY29uc3QgY29tbWFuZCA9IG5ldyBUcmFuc2FjdFdyaXRlQ29tbWFuZChhcmdzKTtcbiAgICBpZiAodHlwZW9mIG9wdGlvbnNPckNiID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHRoaXMuc2VuZChjb21tYW5kLCBvcHRpb25zT3JDYik7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgY2IgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgaWYgKHR5cGVvZiBvcHRpb25zT3JDYiAhPT0gXCJvYmplY3RcIikgdGhyb3cgbmV3IEVycm9yKGBFeHBlY3QgaHR0cCBvcHRpb25zIGJ1dCBnZXQgJHt0eXBlb2Ygb3B0aW9uc09yQ2J9YCk7XG4gICAgICB0aGlzLnNlbmQoY29tbWFuZCwgb3B0aW9uc09yQ2IgfHwge30sIGNiKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuc2VuZChjb21tYW5kLCBvcHRpb25zT3JDYik7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIEFjY2VwdHMgbmF0aXZlIEphdmFTY3JpcHQgdHlwZXMgaW5zdGVhZCBvZiBgQXR0cmlidXRlVmFsdWVgcywgYW5kIGNhbGxzXG4gICAqIFVwZGF0ZUl0ZW1Db21tYW5kIG9wZXJhdGlvbiBmcm9tIHtAbGluayBodHRwczovL3d3dy5ucG1qcy5jb20vcGFja2FnZS9AYXdzLXNkay9jbGllbnQtZHluYW1vZGIgQGF3cy1zZGsvY2xpZW50LWR5bmFtb2RifS5cbiAgICpcbiAgICogSmF2YVNjcmlwdCBvYmplY3RzIHBhc3NlZCBpbiBhcyBwYXJhbWV0ZXJzIGFyZSBtYXJzaGFsbGVkIGludG8gYEF0dHJpYnV0ZVZhbHVlYCBzaGFwZXNcbiAgICogcmVxdWlyZWQgYnkgQW1hem9uIER5bmFtb0RCLiBSZXNwb25zZXMgZnJvbSBEeW5hbW9EQiBhcmUgdW5tYXJzaGFsbGVkIGludG8gcGxhaW4gSmF2YVNjcmlwdCBvYmplY3RzLlxuICAgKi9cbiAgcHVibGljIHVwZGF0ZShhcmdzOiBVcGRhdGVDb21tYW5kSW5wdXQsIG9wdGlvbnM/OiBfX0h0dHBIYW5kbGVyT3B0aW9ucyk6IFByb21pc2U8VXBkYXRlQ29tbWFuZE91dHB1dD47XG4gIHB1YmxpYyB1cGRhdGUoYXJnczogVXBkYXRlQ29tbWFuZElucHV0LCBjYjogKGVycjogYW55LCBkYXRhPzogVXBkYXRlQ29tbWFuZE91dHB1dCkgPT4gdm9pZCk6IHZvaWQ7XG4gIHB1YmxpYyB1cGRhdGUoXG4gICAgYXJnczogVXBkYXRlQ29tbWFuZElucHV0LFxuICAgIG9wdGlvbnM6IF9fSHR0cEhhbmRsZXJPcHRpb25zLFxuICAgIGNiOiAoZXJyOiBhbnksIGRhdGE/OiBVcGRhdGVDb21tYW5kT3V0cHV0KSA9PiB2b2lkXG4gICk6IHZvaWQ7XG4gIHB1YmxpYyB1cGRhdGUoXG4gICAgYXJnczogVXBkYXRlQ29tbWFuZElucHV0LFxuICAgIG9wdGlvbnNPckNiPzogX19IdHRwSGFuZGxlck9wdGlvbnMgfCAoKGVycjogYW55LCBkYXRhPzogVXBkYXRlQ29tbWFuZE91dHB1dCkgPT4gdm9pZCksXG4gICAgY2I/OiAoZXJyOiBhbnksIGRhdGE/OiBVcGRhdGVDb21tYW5kT3V0cHV0KSA9PiB2b2lkXG4gICk6IFByb21pc2U8VXBkYXRlQ29tbWFuZE91dHB1dD4gfCB2b2lkIHtcbiAgICBjb25zdCBjb21tYW5kID0gbmV3IFVwZGF0ZUNvbW1hbmQoYXJncyk7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zT3JDYiA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICB0aGlzLnNlbmQoY29tbWFuZCwgb3B0aW9uc09yQ2IpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGNiID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIGlmICh0eXBlb2Ygb3B0aW9uc09yQ2IgIT09IFwib2JqZWN0XCIpIHRocm93IG5ldyBFcnJvcihgRXhwZWN0IGh0dHAgb3B0aW9ucyBidXQgZ2V0ICR7dHlwZW9mIG9wdGlvbnNPckNifWApO1xuICAgICAgdGhpcy5zZW5kKGNvbW1hbmQsIG9wdGlvbnNPckNiIHx8IHt9LCBjYik7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLnNlbmQoY29tbWFuZCwgb3B0aW9uc09yQ2IpO1xuICAgIH1cbiAgfVxufVxuIl19